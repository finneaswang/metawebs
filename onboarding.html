<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Open WebUI è®¾ç½®å‘å¯¼</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        .wizard-container {
            background: white;
            border-radius: 20px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.1);
            width: 90%;
            max-width: 800px;
            overflow: hidden;
        }
        
        .wizard-header {
            background: linear-gradient(135deg, #2563eb, #3b82f6);
            color: white;
            padding: 40px;
            text-align: center;
        }
        
        .wizard-header h1 {
            font-size: 2.5rem;
            margin-bottom: 10px;
        }
        
        .wizard-header p {
            font-size: 1.1rem;
            opacity: 0.9;
        }
        
        .wizard-content {
            padding: 40px;
        }
        
        .step {
            display: none;
            animation: fadeIn 0.5s ease-in;
        }
        
        .step.active {
            display: block;
        }
        
        .step h2 {
            color: #1f2937;
            margin-bottom: 20px;
            font-size: 1.8rem;
        }
        
        .step-content {
            margin-bottom: 30px;
        }
        
        .status-check {
            background: #f8fafc;
            border: 1px solid #e2e8f0;
            border-radius: 12px;
            padding: 20px;
            margin: 20px 0;
        }
        
        .status-item {
            display: flex;
            align-items: center;
            margin: 10px 0;
            font-size: 1.1rem;
        }
        
        .status-icon {
            width: 24px;
            height: 24px;
            margin-right: 12px;
            font-size: 1.2rem;
        }
        
        .api-key-form {
            background: #f8fafc;
            border-radius: 12px;
            padding: 25px;
            margin: 20px 0;
        }
        
        .form-group {
            margin-bottom: 20px;
        }
        
        .form-group label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            color: #374151;
        }
        
        .form-group input {
            width: 100%;
            padding: 12px 16px;
            border: 2px solid #e5e7eb;
            border-radius: 8px;
            font-size: 1rem;
            transition: border-color 0.2s;
        }
        
        .form-group input:focus {
            outline: none;
            border-color: #2563eb;
        }
        
        .form-group small {
            color: #6b7280;
            font-size: 0.9rem;
            margin-top: 5px;
            display: block;
        }
        
        .button-group {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-top: 30px;
        }
        
        .btn {
            padding: 12px 24px;
            border: none;
            border-radius: 8px;
            font-size: 1rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.2s;
            text-decoration: none;
            display: inline-block;
            text-align: center;
        }
        
        .btn-primary {
            background: #2563eb;
            color: white;
        }
        
        .btn-primary:hover {
            background: #1d4ed8;
        }
        
        .btn-secondary {
            background: #6b7280;
            color: white;
        }
        
        .btn-secondary:hover {
            background: #4b5563;
        }
        
        .btn-success {
            background: #10b981;
            color: white;
        }
        
        .btn-success:hover {
            background: #059669;
        }
        
        .progress-bar {
            width: 100%;
            height: 6px;
            background: #e5e7eb;
            border-radius: 3px;
            margin-bottom: 30px;
            overflow: hidden;
        }
        
        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, #2563eb, #3b82f6);
            border-radius: 3px;
            transition: width 0.5s ease;
        }
        
        .feature-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin: 20px 0;
        }
        
        .feature-card {
            background: #f8fafc;
            border: 1px solid #e2e8f0;
            border-radius: 12px;
            padding: 20px;
            text-align: center;
        }
        
        .feature-icon {
            font-size: 2rem;
            margin-bottom: 10px;
        }
        
        .tips-list {
            background: #fef3c7;
            border: 1px solid #f59e0b;
            border-radius: 12px;
            padding: 20px;
            margin: 20px 0;
        }
        
        .tips-list h3 {
            color: #92400e;
            margin-bottom: 15px;
        }
        
        .tips-list ul {
            list-style: none;
            padding: 0;
        }
        
        .tips-list li {
            margin: 8px 0;
            padding-left: 20px;
            position: relative;
        }
        
        .tips-list li:before {
            content: "ğŸ’¡";
            position: absolute;
            left: 0;
        }
        
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        .loading {
            display: inline-block;
            width: 20px;
            height: 20px;
            border: 2px solid #f3f3f3;
            border-top: 2px solid #2563eb;
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }
        
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
    </style>
</head>
<body>
    <div class="wizard-container">
        <div class="wizard-header">
            <h1>ğŸš€ Open WebUI</h1>
            <p>æ¬¢è¿ä½¿ç”¨AIèŠå¤©ç•Œé¢ï¼è®©æˆ‘ä»¬å¼€å§‹è®¾ç½®ä¹‹æ—…</p>
        </div>
        
        <div class="wizard-content">
            <div class="progress-bar">
                <div class="progress-fill" id="progressFill" style="width: 20%"></div>
            </div>
            
            <!-- æ­¥éª¤ 1: æ¬¢è¿ -->
            <div class="step active" id="step1">
                <h2>ğŸ‘‹ æ¬¢è¿ä½¿ç”¨ Open WebUI</h2>
                <div class="step-content">
                    <p style="font-size: 1.1rem; line-height: 1.6; color: #4b5563;">
                        Open WebUI æ˜¯ä¸€ä¸ªç°ä»£åŒ–çš„AIèŠå¤©ç•Œé¢ï¼Œæ”¯æŒå¤šç§AIæ¨¡å‹ã€‚è®©æˆ‘ä»¬èŠ±å‡ åˆ†é’Ÿæ—¶é—´æ¥è®¾ç½®ä½ çš„ä¸“å±AIåŠ©æ‰‹ã€‚
                    </p>
                    
                    <div class="feature-grid">
                        <div class="feature-card">
                            <div class="feature-icon">ğŸ¤–</div>
                            <h3>å¤šæ¨¡å‹æ”¯æŒ</h3>
                            <p>GPT-4, Claude, Mistralç­‰</p>
                        </div>
                        <div class="feature-card">
                            <div class="feature-icon">âš™ï¸</div>
                            <h3>å‚æ•°è°ƒèŠ‚</h3>
                            <p>æ¸©åº¦ã€é•¿åº¦ã€æç¤ºè¯</p>
                        </div>
                        <div class="feature-card">
                            <div class="feature-icon">ğŸ’¬</div>
                            <h3>èŠå¤©ç®¡ç†</h3>
                            <p>å†å²è®°å½•ã€å¯¼å‡ºåŠŸèƒ½</p>
                        </div>
                    </div>
                </div>
                
                <div class="button-group">
                    <div></div>
                    <button class="btn btn-primary" onclick="nextStep()">å¼€å§‹è®¾ç½® â†’</button>
                </div>
            </div>
            
            <!-- æ­¥éª¤ 2: æ£€æŸ¥æœåŠ¡çŠ¶æ€ -->
            <div class="step" id="step2">
                <h2>ğŸ” æ£€æŸ¥æœåŠ¡çŠ¶æ€</h2>
                <div class="step-content">
                    <p>è®©æˆ‘ä»¬æ£€æŸ¥ Open WebUI æœåŠ¡æ˜¯å¦æ­£å¸¸è¿è¡Œ...</p>
                    
                    <div class="status-check">
                        <div class="status-item" id="serviceStatus">
                            <div class="loading"></div>
                            <span>æ£€æŸ¥æœåŠ¡çŠ¶æ€...</span>
                        </div>
                        <div class="status-item" id="portStatus">
                            <span class="status-icon">â³</span>
                            <span>æ£€æŸ¥ç«¯å£è®¿é—®...</span>
                        </div>
                    </div>
                </div>
                
                <div class="button-group">
                    <button class="btn btn-secondary" onclick="prevStep()">â† è¿”å›</button>
                    <button class="btn btn-primary" id="step2Next" onclick="nextStep()" disabled>ä¸‹ä¸€æ­¥ â†’</button>
                </div>
            </div>
            
            <!-- æ­¥éª¤ 3: APIå¯†é’¥è®¾ç½® -->
            <div class="step" id="step3">
                <h2>ğŸ”‘ è®¾ç½® API å¯†é’¥</h2>
                <div class="step-content">
                    <p>ä¸ºäº†ä½¿ç”¨AIåŠŸèƒ½ï¼Œä½ éœ€è¦è®¾ç½®è‡³å°‘ä¸€ä¸ªAPIå¯†é’¥ï¼š</p>
                    
                    <div class="api-key-form">
                        <div class="form-group">
                            <label for="openrouterKey">OpenRouter API å¯†é’¥ (æ¨è)</label>
                            <input type="password" id="openrouterKey" placeholder="è¾“å…¥ä½ çš„ OpenRouter API å¯†é’¥">
                            <small>æ”¯æŒå¤šç§æ¨¡å‹ï¼Œè·å–å¯†é’¥: <a href="https://openrouter.ai/keys" target="_blank">https://openrouter.ai/keys</a></small>
                        </div>
                        
                        <div class="form-group">
                            <label for="openaiKey">OpenAI API å¯†é’¥</label>
                            <input type="password" id="openaiKey" placeholder="è¾“å…¥ä½ çš„ OpenAI API å¯†é’¥">
                            <small>å®˜æ–¹GPTæ¨¡å‹ï¼Œè·å–å¯†é’¥: <a href="https://platform.openai.com/api-keys" target="_blank">https://platform.openai.com/api-keys</a></small>
                        </div>
                        
                        <button class="btn btn-primary" onclick="testApiKeys()" id="testKeysBtn">
                            <span id="testKeysText">æµ‹è¯•å¯†é’¥</span>
                        </button>
                        
                        <div id="keyTestResult" style="margin-top: 15px;"></div>
                    </div>
                </div>
                
                <div class="button-group">
                    <button class="btn btn-secondary" onclick="prevStep()">â† è¿”å›</button>
                    <button class="btn btn-primary" onclick="nextStep()">ç¨åè®¾ç½® â†’</button>
                </div>
            </div>
            
            <!-- æ­¥éª¤ 4: ä½¿ç”¨æŒ‡å— -->
            <div class="step" id="step4">
                <h2>ğŸ“š ä½¿ç”¨æŒ‡å—</h2>
                <div class="step-content">
                    <p>ä»¥ä¸‹æ˜¯ä¸€äº›ä½¿ç”¨æŠ€å·§ï¼Œå¸®ä½ å¿«é€Ÿä¸Šæ‰‹ï¼š</p>
                    
                    <div class="tips-list">
                        <h3>ğŸ’¡ å¿«é€Ÿä¸Šæ‰‹æŠ€å·§</h3>
                        <ul>
                            <li>ç‚¹å‡»å³ä¸Šè§’ âš™ï¸ å›¾æ ‡è¿›å…¥è®¾ç½®</li>
                            <li>åœ¨"è¿æ¥"é€‰é¡¹å¡ä¸­å¯ä»¥é…ç½®APIå¯†é’¥</li>
                            <li>é€‰æ‹©ä¸åŒçš„AIæ¨¡å‹ä½“éªŒä¸åŒé£æ ¼</li>
                            <li>è°ƒæ•´Temperatureæ§åˆ¶å›å¤çš„åˆ›é€ æ€§</li>
                            <li>ä½¿ç”¨System Promptå®šåˆ¶AIè§’è‰²</li>
                            <li>å·¦ä¾§é¢æ¿å¯æŸ¥çœ‹èŠå¤©å†å²</li>
                            <li>æ”¯æŒæ·±è‰²æ¨¡å¼å’Œå¤šç§ä¸»é¢˜</li>
                        </ul>
                    </div>
                    
                    <div class="feature-grid">
                        <div class="feature-card">
                            <div class="feature-icon">ğŸ¨</div>
                            <h3>ä¸ªæ€§åŒ–è®¾ç½®</h3>
                            <p>ä¸»é¢˜ã€è¯­è¨€ã€ç•Œé¢å¸ƒå±€</p>
                        </div>
                        <div class="feature-card">
                            <div class="feature-icon">ğŸ“¤</div>
                            <h3>å¯¼å‡ºåŠŸèƒ½</h3>
                            <p>ä¿å­˜é‡è¦å¯¹è¯å†…å®¹</p>
                        </div>
                        <div class="feature-card">
                            <div class="feature-icon">ğŸ”Œ</div>
                            <h3>æ‰©å±•åŠŸèƒ½</h3>
                            <p>æ’ä»¶ã€å·¥å…·é›†æˆ</p>
                        </div>
                    </div>
                </div>
                
                <div class="button-group">
                    <button class="btn btn-secondary" onclick="prevStep()">â† è¿”å›</button>
                    <button class="btn btn-success" onclick="finishSetup()">å¼€å§‹ä½¿ç”¨ ğŸš€</button>
                </div>
            </div>
        </div>
    </div>

    <script>
        let currentStep = 1;
        const totalSteps = 4;

        function updateProgress() {
            const progress = (currentStep / totalSteps) * 100;
            document.getElementById('progressFill').style.width = progress + '%';
        }

        function showStep(step) {
            // éšè—æ‰€æœ‰æ­¥éª¤
            document.querySelectorAll('.step').forEach(s => s.classList.remove('active'));
            
            // æ˜¾ç¤ºå½“å‰æ­¥éª¤
            document.getElementById(`step${step}`).classList.add('active');
            
            // æ›´æ–°è¿›åº¦æ¡
            updateProgress();
            
            // ç‰¹æ®Šå¤„ç†
            if (step === 2) {
                checkServiceStatus();
            }
        }

        function nextStep() {
            if (currentStep < totalSteps) {
                currentStep++;
                showStep(currentStep);
            }
        }

        function prevStep() {
            if (currentStep > 1) {
                currentStep--;
                showStep(currentStep);
            }
        }

        async function checkServiceStatus() {
            const serviceStatus = document.getElementById('serviceStatus');
            const portStatus = document.getElementById('portStatus');
            const nextBtn = document.getElementById('step2Next');
            
            try {
                // æ£€æŸ¥ç«¯å£3001
                const response = await fetch('http://localhost:3001', { 
                    method: 'HEAD',
                    mode: 'no-cors'
                });
                
                serviceStatus.innerHTML = '<span class="status-icon">âœ…</span><span>Open WebUI æœåŠ¡æ­£å¸¸è¿è¡Œ</span>';
                portStatus.innerHTML = '<span class="status-icon">âœ…</span><span>ç«¯å£ 3001 å¯è®¿é—®</span>';
                nextBtn.disabled = false;
                
            } catch (error) {
                serviceStatus.innerHTML = '<span class="status-icon">âŒ</span><span>æœåŠ¡å¯èƒ½æœªå¯åŠ¨</span>';
                portStatus.innerHTML = '<span class="status-icon">âŒ</span><span>ç«¯å£ 3001 æ— æ³•è®¿é—®</span>';
                
                // æ˜¾ç¤ºè§£å†³æ–¹æ¡ˆ
                const statusCheck = document.querySelector('.status-check');
                statusCheck.innerHTML += `
                    <div style="margin-top: 20px; padding: 15px; background: #fee2e2; border-radius: 8px; border: 1px solid #fecaca;">
                        <h4 style="color: #991b1b; margin-bottom: 10px;">ğŸš¨ éœ€è¦å¯åŠ¨æœåŠ¡</h4>
                        <p style="color: #991b1b; margin-bottom: 10px;">è¯·åœ¨ç»ˆç«¯è¿è¡Œä»¥ä¸‹å‘½ä»¤å¯åŠ¨ Open WebUI:</p>
                        <code style="background: #1f2937; color: #f9fafb; padding: 8px 12px; border-radius: 4px; display: block;">
                            python3 deploy_openwebui.py
                        </code>
                        <p style="color: #991b1b; margin-top: 10px; font-size: 0.9rem;">å¯åŠ¨ååˆ·æ–°æ­¤é¡µé¢ç»§ç»­è®¾ç½®</p>
                    </div>
                `;
                
                // æ·»åŠ åˆ·æ–°æŒ‰é’®
                nextBtn.textContent = 'åˆ·æ–°æ£€æŸ¥';
                nextBtn.disabled = false;
                nextBtn.onclick = () => {
                    location.reload();
                };
            }
        }

        async function testApiKeys() {
            const openrouterKey = document.getElementById('openrouterKey').value.trim();
            const openaiKey = document.getElementById('openaiKey').value.trim();
            const testBtn = document.getElementById('testKeysBtn');
            const testText = document.getElementById('testKeysText');
            const result = document.getElementById('keyTestResult');
            
            if (!openrouterKey && !openaiKey) {
                result.innerHTML = '<div style="color: #f59e0b;">âš ï¸ è¯·è‡³å°‘è¾“å…¥ä¸€ä¸ªAPIå¯†é’¥</div>';
                return;
            }
            
            testBtn.disabled = true;
            testText.innerHTML = '<div class="loading" style="width: 16px; height: 16px; margin-right: 8px;"></div>æµ‹è¯•ä¸­...';
            
            // æ¨¡æ‹ŸAPIæµ‹è¯•ï¼ˆå®é™…åº”ç”¨ä¸­éœ€è¦åç«¯éªŒè¯ï¼‰
            setTimeout(() => {
                let resultHtml = '<div style="color: #10b981;">âœ… å¯†é’¥è®¾ç½®æˆåŠŸï¼</div>';
                
                if (openrouterKey) {
                    resultHtml += '<div style="color: #6b7280; font-size: 0.9rem; margin-top: 5px;">OpenRouter å¯†é’¥å·²é…ç½®</div>';
                }
                if (openaiKey) {
                    resultHtml += '<div style="color: #6b7280; font-size: 0.9rem; margin-top: 5px;">OpenAI å¯†é’¥å·²é…ç½®</div>';
                }
                
                result.innerHTML = resultHtml;
                testBtn.disabled = false;
                testText.textContent = 'é‡æ–°æµ‹è¯•';
                
                // ä¿å­˜åˆ°localStorageï¼ˆå®é™…åº”ç”¨ä¸­åº”è¯¥å‘é€åˆ°åç«¯ï¼‰
                if (openrouterKey) localStorage.setItem('openrouter_key', openrouterKey);
                if (openaiKey) localStorage.setItem('openai_key', openaiKey);
                
            }, 2000);
        }

        function finishSetup() {
            // æ‰“å¼€Open WebUI
            window.open('http://localhost:3001', '_blank');
            
            // æ˜¾ç¤ºå®Œæˆæ¶ˆæ¯
            document.querySelector('.wizard-container').innerHTML = `
                <div class="wizard-header">
                    <h1>ğŸ‰ è®¾ç½®å®Œæˆï¼</h1>
                    <p>Open WebUI å·²ç»ä¸ºä½ å‡†å¤‡å°±ç»ª</p>
                </div>
                <div style="padding: 40px; text-align: center;">
                    <div style="font-size: 4rem; margin-bottom: 20px;">ğŸš€</div>
                    <h2 style="color: #1f2937; margin-bottom: 20px;">æ¬¢è¿ä½¿ç”¨ Open WebUIï¼</h2>
                    <p style="color: #6b7280; font-size: 1.1rem; margin-bottom: 30px;">
                        ä½ çš„AIèŠå¤©ç•Œé¢å·²ç»åœ¨æ–°æ ‡ç­¾é¡µä¸­æ‰“å¼€ã€‚å¼€å§‹ä¸AIå¯¹è¯å§ï¼
                    </p>
                    <a href="http://localhost:3001" class="btn btn-primary" target="_blank">
                        æ‰“å¼€ Open WebUI
                    </a>
                </div>
            `;
        }

        // é¡µé¢åŠ è½½æ—¶çš„åˆå§‹åŒ–
        window.addEventListener('load', function() {
            updateProgress();
        });
    </script>
</body>
</html>
